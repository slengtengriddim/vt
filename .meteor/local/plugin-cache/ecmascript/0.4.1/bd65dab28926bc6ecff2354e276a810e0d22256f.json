{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/server/publication.js","filenameRelative":"/server/publication.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/server/publication.js.map","sourceFileName":"/server/publication.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"publication"},"ignored":false,"code":"Meteor.publish('vocabularyRegister', function (search) {\n\tcheck(search, Match.OneOf(String, null, undefined));\n\n\tvar query = {},\n\t    projection = {\n\t\tlimit: 0,\n\t\tsort: {\n\t\t\tterm: 1\n\t\t}\n\t};\n\n\tif (search) {\n\t\tvar regex = new RegExp(search, 'i');\n\t\tquery = {\n\t\t\t$or: [{\n\t\t\t\tterm: regex\n\t\t\t}, {\n\t\t\t\tdescription: regex\n\t\t\t}]\n\t\t};\n\t\tprojection.limit = 0;\n\t}\n\treturn Vocabulary.find(query, projection);\n});\n\nMeteor.publish(\"vocabularyAll\", function () {\n\tvar data = Vocabulary.find({});\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish(\"vocabularyFavourised\", function () {\n\tvar currentUserId = this.userId;\n\tvar favIds = R.pluck('vocabularyId')(Favourites.find({\n\t\tuserId: currentUserId\n\t}).fetch());\n\tvar data = Vocabulary.find({\n\t\t_id: {\n\t\t\t$in: favIds\n\t\t}\n\t});\n\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish(\"vocabularyWithoutFavourised\", function () {\n\tvar currentUserId = this.userId;\n\tvar favIds = R.pluck('vocabularyId')(Favourites.find({\n\t\tuserId: currentUserId\n\t}).fetch());\n\tvar data = Vocabulary.find({\n\t\t_id: {\n\t\t\t$nin: favIds\n\t\t}\n\t});\n\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish(\"ownedFavourites\", function () {\n\tvar currentUserId = this.userId;\n\tvar data = Favourites.find({\n\t\tuserId: currentUserId\n\t});\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish('singleEntry', function (entryId) {\n\treturn Vocabulary.find({\n\t\t_id: entryId\n\t});\n});","ast":null,"map":{"version":3,"sources":["/server/publication.js"],"names":[],"mappings":"AAAA,OAAO,OAAP,CAAe,oBAAf,EAAqC,UAAS,MAAT,EAAiB;AACrD,OAAM,MAAN,EAAc,MAAM,KAAN,CAAY,MAAZ,EAAoB,IAApB,EAA0B,SAA1B,CAAd,EADqD;;AAGrD,KAAI,QAAQ,EAAR;KACH,aAAa;AACZ,SAAO,CAAP;AACA,QAAM;AACL,SAAM,CAAN;GADD;EAFD,CAJoD;;AAWrD,KAAI,MAAJ,EAAY;AACX,MAAI,QAAQ,IAAI,MAAJ,CAAW,MAAX,EAAmB,GAAnB,CAAR,CADO;AAEX,UAAQ;AACP,QAAK,CAAC;AACL,UAAM,KAAN;IADI,EAEF;AACF,iBAAa,KAAb;IAHI,CAAL;GADD,CAFW;AASX,aAAW,KAAX,GAAmB,CAAnB,CATW;EAAZ;AAWA,QAAO,WAAW,IAAX,CAAgB,KAAhB,EAAuB,UAAvB,CAAP,CAtBqD;CAAjB,CAArC;;AAyBA,OAAO,OAAP,CAAe,eAAf,EAAgC,YAAW;AAC1C,KAAI,OAAO,WAAW,IAAX,CAAgB,EAAhB,CAAP,CADsC;AAE1C,KAAI,IAAJ,EAAU;AACT,SAAO,IAAP,CADS;EAAV;AAGA,QAAO,KAAK,KAAL,EAAP,CAL0C;CAAX,CAAhC;;AAQA,OAAO,OAAP,CAAe,sBAAf,EAAuC,YAAW;AACjD,KAAI,gBAAgB,KAAK,MAAL,CAD6B;AAEjD,KAAI,SAAS,EAAE,KAAF,CAAQ,cAAR,EAAwB,WAAW,IAAX,CAAgB;AACpD,UAAQ,aAAR;EADoC,EAElC,KAFkC,EAAxB,CAAT,CAF6C;AAKjD,KAAI,OAAO,WAAW,IAAX,CAAgB;AAC1B,OAAK;AACJ,QAAK,MAAL;GADD;EADU,CAAP,CAL6C;;AAWjD,KAAI,IAAJ,EAAU;AACT,SAAO,IAAP,CADS;EAAV;AAGA,QAAO,KAAK,KAAL,EAAP,CAdiD;CAAX,CAAvC;;AAiBA,OAAO,OAAP,CAAe,6BAAf,EAA8C,YAAW;AACxD,KAAI,gBAAgB,KAAK,MAAL,CADoC;AAExD,KAAI,SAAS,EAAE,KAAF,CAAQ,cAAR,EAAwB,WAAW,IAAX,CAAgB;AACpD,UAAQ,aAAR;EADoC,EAElC,KAFkC,EAAxB,CAAT,CAFoD;AAKxD,KAAI,OAAO,WAAW,IAAX,CAAgB;AAC1B,OAAK;AACJ,SAAM,MAAN;GADD;EADU,CAAP,CALoD;;AAWxD,KAAI,IAAJ,EAAU;AACT,SAAO,IAAP,CADS;EAAV;AAGA,QAAO,KAAK,KAAL,EAAP,CAdwD;CAAX,CAA9C;;AAiBA,OAAO,OAAP,CAAe,iBAAf,EAAkC,YAAW;AAC5C,KAAI,gBAAgB,KAAK,MAAL,CADwB;AAE5C,KAAI,OAAO,WAAW,IAAX,CAAgB;AAC1B,UAAQ,aAAR;EADU,CAAP,CAFwC;AAK5C,KAAI,IAAJ,EAAU;AACT,SAAO,IAAP,CADS;EAAV;AAGA,QAAO,KAAK,KAAL,EAAP,CAR4C;CAAX,CAAlC;;AAWA,OAAO,OAAP,CAAe,aAAf,EAA8B,UAAS,OAAT,EAAkB;AAC/C,QAAO,WAAW,IAAX,CAAgB;AACtB,OAAK,OAAL;EADM,CAAP,CAD+C;CAAlB,CAA9B","file":"/server/publication.js.map","sourcesContent":["Meteor.publish('vocabularyRegister', function(search) {\n\tcheck(search, Match.OneOf(String, null, undefined));\n\n\tlet query = {},\n\t\tprojection = {\n\t\t\tlimit: 0,\n\t\t\tsort: {\n\t\t\t\tterm: 1\n\t\t\t}\n\t\t};\n\n\tif (search) {\n\t\tlet regex = new RegExp(search, 'i');\n\t\tquery = {\n\t\t\t$or: [{\n\t\t\t\tterm: regex\n\t\t\t}, {\n\t\t\t\tdescription: regex\n\t\t\t}]\n\t\t};\n\t\tprojection.limit = 0;\n\t}\n\treturn Vocabulary.find(query, projection);\n});\n\nMeteor.publish(\"vocabularyAll\", function() {\n\tlet data = Vocabulary.find({});\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish(\"vocabularyFavourised\", function() {\n\tlet currentUserId = this.userId;\n\tlet favIds = R.pluck('vocabularyId')(Favourites.find({\n\t\tuserId: currentUserId\n\t}).fetch());\n\tlet data = Vocabulary.find({\n\t\t_id: {\n\t\t\t$in: favIds\n\t\t}\n\t});\n\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish(\"vocabularyWithoutFavourised\", function() {\n\tlet currentUserId = this.userId;\n\tlet favIds = R.pluck('vocabularyId')(Favourites.find({\n\t\tuserId: currentUserId\n\t}).fetch());\n\tlet data = Vocabulary.find({\n\t\t_id: {\n\t\t\t$nin: favIds\n\t\t}\n\t});\n\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish(\"ownedFavourites\", function() {\n\tlet currentUserId = this.userId;\n\tlet data = Favourites.find({\n\t\tuserId: currentUserId\n\t});\n\tif (data) {\n\t\treturn data;\n\t}\n\treturn this.ready();\n});\n\nMeteor.publish('singleEntry', function(entryId) {\n\treturn Vocabulary.find({\n\t\t_id: entryId\n\t});\n});\n"]},"hash":"bd65dab28926bc6ecff2354e276a810e0d22256f"}
