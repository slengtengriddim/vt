{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/views/register/register.js","filenameRelative":"/client/views/register/register.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/views/register/register.js.map","sourceFileName":"/client/views/register/register.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"register"},"ignored":false,"code":"Template.register.onCreated(function () {\n\tvar template = Template.instance();\n\n\ttemplate.searchQuery = new ReactiveVar();\n\ttemplate.searching = new ReactiveVar(false);\n\ttemplate.isAlphabetic = new ReactiveVar(true);\n\ttemplate.isLength64 = new ReactiveVar(true);\n\n\tTracker.autorun(function () {\n\t\ttemplate.subscribe('vocabularyRegister', template.searchQuery.get(), function () {\n\t\t\tsetTimeout(function () {\n\t\t\t\ttemplate.searching.set(false);\n\t\t\t}, 300);\n\t\t});\n\t\ttemplate.subscribe('ownedFavourites');\n\n\t\t// Session.set(LENGTH_FAV, Favourites.find().count());\n\t\t// Session.set(LENGTH_NOT_FAV, Vocabulary.find().count() - Favourites.find().count());\n\t});\n});\n\nTemplate.register.helpers({\n\tsearching: function () {\n\t\tfunction searching() {\n\t\t\treturn Template.instance().searching.get();\n\t\t}\n\n\t\treturn searching;\n\t}(),\n\tquery: function () {\n\t\tfunction query() {\n\t\t\treturn Template.instance().searchQuery.get();\n\t\t}\n\n\t\treturn query;\n\t}(),\n\tisAlphabetic: function () {\n\t\tfunction isAlphabetic() {\n\t\t\treturn Template.instance().isAlphabetic.get();\n\t\t}\n\n\t\treturn isAlphabetic;\n\t}(),\n\tisLength64: function () {\n\t\tfunction isLength64() {\n\t\t\treturn Template.instance().isLength64.get();\n\t\t}\n\n\t\treturn isLength64;\n\t}(),\n\tvocabulary: function () {\n\t\tfunction vocabulary() {\n\t\t\t// Sort and group entries by letter and create a new array of iterable objects for cascaded template iteration\n\t\t\tvar vocabularyIndexed = [];\n\t\t\tvar alphabet = R.split('', 'abcdefghijklmnopqrstuvwxyz'.toUpperCase());\n\t\t\tvar regex = function () {\n\t\t\t\tfunction regex(letter) {\n\t\t\t\t\treturn new RegExp(\"^\" + letter, \"i\");\n\t\t\t\t}\n\n\t\t\t\treturn regex;\n\t\t\t}();\n\n\t\t\talphabet.forEach(function (entry) {\n\t\t\t\tvar array = Vocabulary.find({\n\t\t\t\t\tterm: {\n\t\t\t\t\t\t$in: [regex(entry)]\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tsort: {\n\t\t\t\t\t\tterm: 1\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (array.count() !== 0) {\n\t\t\t\t\tvocabularyIndexed.push({\n\t\t\t\t\t\t'letter': entry,\n\t\t\t\t\t\t'entries': array\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (vocabularyIndexed) {\n\t\t\t\treturn vocabularyIndexed;\n\t\t\t}\n\t\t}\n\n\t\treturn vocabulary;\n\t}()\n});\n\nTemplate.register.events({\n\t'keyup [name=\"search\"]': function () {\n\t\tfunction keyupNameSearch(event, template) {\n\t\t\tvar value = event.target.value;\n\t\t\tconsole.log(value);\n\t\t\tif (value !== '') {\n\t\t\t\t// check if string is valid\n\t\t\t\tif (Validate.isAlphabetic(value)) {\n\t\t\t\t\ttemplate.isAlphabetic.set(true);\n\t\t\t\t} else {\n\t\t\t\t\ttemplate.isAlphabetic.set(false);\n\t\t\t\t}\n\t\t\t\tif (Validate.isLength64(value)) {\n\t\t\t\t\ttemplate.isLength64.set(true);\n\t\t\t\t} else {\n\t\t\t\t\ttemplate.isLength64.set(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// && event.keyCode === 13\n\t\t\tif (value !== '') {\n\t\t\t\tif (template.isAlphabetic.get() && template.isLength64.get()) {\n\t\t\t\t\ttemplate.searchQuery.set(value);\n\t\t\t\t\ttemplate.searching.set(true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value === '') {\n\t\t\t\ttemplate.searchQuery.set(value);\n\t\t\t\ttemplate.isAlphabetic.set(true);\n\t\t\t\ttemplate.isLength64.set(true);\n\t\t\t}\n\t\t}\n\n\t\treturn keyupNameSearch;\n\t}(),\n\t'click .btn-fav': function () {\n\t\tfunction clickBtnFav(event, template) {\n\t\t\tMeteor.call('toggleFavourite', this._id);\n\n\t\t\t// TODO DRY\n\t\t\tif (Favourites.find({\n\t\t\t\tvocabularyId: this._id\n\t\t\t}).count() === 0) {\n\t\t\t\t// add to favourites\n\t\t\t\tif (Session.get(RANDOM_NOT_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_NOT_FAV) - 1) {\n\t\t\t\t\tvar val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t\t}\n\t\t\t\tif (Session.get(LENGTH_NOT_FAV) === 1) {\n\t\t\t\t\tSession.set(RANDOM_FAV, true);\n\t\t\t\t\tSession.set(RANDOM_NOT_FAV, false);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// remove from favourites\n\t\t\t\tif (Session.get(RANDOM_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_FAV) - 1) {\n\t\t\t\t\tvar _val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_FAV);\n\t\t\t\t\tSession.set(COUNT_VIEWED, _val);\n\t\t\t\t}\n\t\t\t\tif (Session.get(LENGTH_FAV) === 1) {\n\t\t\t\t\tSession.set(RANDOM_FAV, false);\n\t\t\t\t\tSession.set(RANDOM_NOT_FAV, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn clickBtnFav;\n\t}()\n});","ast":null,"map":{"version":3,"sources":["/client/views/register/register.js"],"names":[],"mappings":"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","file":"/client/views/register/register.js.map","sourcesContent":["Template.register.onCreated(() => {\n\tlet template = Template.instance();\n\n\ttemplate.searchQuery = new ReactiveVar();\n\ttemplate.searching = new ReactiveVar(false);\n\ttemplate.isAlphabetic = new ReactiveVar(true);\n\ttemplate.isLength64 = new ReactiveVar(true);\n\n\tTracker.autorun(() => {\n\t\ttemplate.subscribe('vocabularyRegister', template.searchQuery.get(), () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\ttemplate.searching.set(false);\n\t\t\t}, 300);\n\t\t});\n\t\ttemplate.subscribe('ownedFavourites');\n\n\t\t// Session.set(LENGTH_FAV, Favourites.find().count());\n\t\t// Session.set(LENGTH_NOT_FAV, Vocabulary.find().count() - Favourites.find().count());\n\t});\n});\n\nTemplate.register.helpers({\n\tsearching() {\n\t\treturn Template.instance().searching.get();\n\t},\n\tquery() {\n\t\treturn Template.instance().searchQuery.get();\n\t},\n\tisAlphabetic() {\n\t\treturn Template.instance().isAlphabetic.get();\n\t},\n\tisLength64() {\n\t\treturn Template.instance().isLength64.get();\n\t},\n\tvocabulary() {\n\t\t// Sort and group entries by letter and create a new array of iterable objects for cascaded template iteration\n\t\tlet vocabularyIndexed = [];\n\t\tlet alphabet = R.split('', 'abcdefghijklmnopqrstuvwxyz'.toUpperCase());\n\t\tlet regex = letter => new RegExp(\"^\" + letter, \"i\");\n\n\t\talphabet.forEach(entry => {\n\t\t\tlet array = Vocabulary.find({\n\t\t\t\tterm: {\n\t\t\t\t\t$in: [regex(entry)]\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tsort: {\n\t\t\t\t\tterm: 1\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (array.count() !== 0) {\n\t\t\t\tvocabularyIndexed.push({\n\t\t\t\t\t'letter': entry,\n\t\t\t\t\t'entries': array\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif (vocabularyIndexed) {\n\t\t\treturn vocabularyIndexed;\n\t\t}\n\t}\n});\n\nTemplate.register.events({\n\t'keyup [name=\"search\"]' (event, template) {\n\t\tlet value = event.target.value;\nconsole.log(value);\n\t\tif (value !== '') {\n\t\t\t// check if string is valid\n\t\t\tif (Validate.isAlphabetic(value)) {\n\t\t\t\ttemplate.isAlphabetic.set(true);\n\t\t\t} else {\n\t\t\t\ttemplate.isAlphabetic.set(false);\n\t\t\t}\n\t\t\tif (Validate.isLength64(value)) {\n\t\t\t\ttemplate.isLength64.set(true);\n\t\t\t} else {\n\t\t\t\ttemplate.isLength64.set(false);\n\t\t\t}\n\t\t}\n// && event.keyCode === 13\n\t\tif (value !== '') {\n\t\t\tif (template.isAlphabetic.get() && template.isLength64.get()) {\n\t\t\t\ttemplate.searchQuery.set(value);\n\t\t\t\ttemplate.searching.set(true);\n\t\t\t}\n\t\t}\n\n\t\tif (value === '') {\n\t\t\ttemplate.searchQuery.set(value);\n\t\t\ttemplate.isAlphabetic.set(true);\n\t\t\ttemplate.isLength64.set(true);\n\t\t}\n\t},\n\n\t'click .btn-fav' (event, template) {\n\t\tMeteor.call('toggleFavourite', this._id);\n\n\t\t// TODO DRY\n\t\tif (Favourites.find({\n\t\t\t\tvocabularyId: this._id\n\t\t\t}).count() === 0) {\n\t\t\t\t// add to favourites\n\t\t\t\tif (Session.get(RANDOM_NOT_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_NOT_FAV) - 1) {\n\t\t\t\t\tlet val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t\t}\n\t\t\t\tif ((Session.get(LENGTH_NOT_FAV) === 1)) {\n\t\t\t\t\tSession.set(RANDOM_FAV, true);\n\t\t\t\t\tSession.set(RANDOM_NOT_FAV, false);\n\t\t\t\t}\n\t\t} else {\n\t\t\t// remove from favourites\n\t\t\tif (Session.get(RANDOM_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_FAV) - 1) {\n\t\t\t\tlet val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t}\n\t\t\tif ((Session.get(LENGTH_FAV) === 1)) {\n\t\t\t\tSession.set(RANDOM_FAV, false);\n\t\t\t\tSession.set(RANDOM_NOT_FAV, true);\n\t\t\t}\n\t\t}\n\t}\n});\n"]},"hash":"99a8eecd2815c98f8a319b4c3fc38a81796acf4f"}
