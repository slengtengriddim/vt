{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/layout/layout.js","filenameRelative":"/client/layout/layout.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/layout/layout.js.map","sourceFileName":"/client/layout/layout.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"layout"},"ignored":false,"code":"Template.layout.onCreated(function () {\n\tthis.autorun(function () {\n\n\t\tSession.set(LENGTH_FAV, Favourites.find().count());\n\t\tSession.set(LENGTH_NOT_FAV, Vocabulary.find().count() - Favourites.find().count());\n\t});\n});\n\n//  Session variables\n\nATTENTION_MODE = 'attentionMode';\nSession.setDefault(ATTENTION_MODE, false);\n\nLAST_PATH = 'lastPath';\nSession.setDefault(LAST_PATH, '/');\n\n// LAST_PATH_TRAINER = 'lastPathTrainer';\n// Session.setDefault(LAST_PATH_TRAINER, '/trainer/lesen');\n\nSOURCE_FAV = 'sourceFavourites';\nSession.setDefault(SOURCE_FAV, false);\n\nRANDOM_FAV = 'randomFavourites';\nSession.setDefault(RANDOM_FAV, false);\n\nRANDOM_NOT_FAV = 'randomNotFavourites';\nSession.setDefault(RANDOM_NOT_FAV, true);\n\nLENGTH_FAV = 'lengthFav';\nSession.setDefault(LENGTH_FAV, 0);\n\nLENGTH_NOT_FAV = 'lengthNotFav';\nSession.setDefault(LENGTH_NOT_FAV, 0);\n\nCOUNT_VIEWED = 'countViewed';\nSession.setDefault(COUNT_VIEWED, 0);\n\nREVEALED = 'revealed';\nSession.setDefault(REVEALED, false);\n\n// TERM_MODE = 'termMode';\n// Session.setDefault(TERM_MODE, true);\n\nTERM_WRONG = 'termWrong';\nSession.setDefault(TERM_WRONG, false);\n\nTERM_RIGHT = 'termRight';\nSession.setDefault(TERM_RIGHT, false);\n\nTERM_CACHE = 'termCache';\nSession.setDefault(TERM_CACHE, '');\n\nCOUNT_LETTERS_MATCH = 'countLettersMatch';\nSession.setDefault(COUNT_LETTERS_MATCH, 0);\n\nNAV_MODE_READ = 'lesen';\nSession.setDefault(NAV_MODE_READ, true);\n\nNAV_MODE_TERM = 'wort';\nSession.setDefault(NAV_MODE_TERM, false);\n\nNAV_MODE_DEF = 'definition';\nSession.setDefault(NAV_MODE_DEF, false);\n\nNAV_MODES = 'navModes';\nSession.setDefault(NAV_MODES, [NAV_MODE_READ, NAV_MODE_TERM, NAV_MODE_DEF]);\n\nNAV_MODE_COUNT = 'navModeCount';\nSession.setDefault(NAV_MODE_COUNT, 0);\n\n// Global helpers\n\n// e.g. {{getSession \"posX\"}} in Template\nTemplate.registerHelper('getSession', function (key) {\n\treturn Session.get(key);\n});\nTemplate.registerHelper('userMail', function () {\n\treturn Meteor.user().emails[0].address;\n});\nTemplate.registerHelper('isOwner', function () {\n\treturn this.userId == Meteor.userId();\n});\nTemplate.registerHelper(\"lengthIsOne\", function () {\n\treturn Session.get(LENGTH_FAV) === 1 && Session.get(SOURCE_FAV) || Session.get(LENGTH_NOT_FAV) === 1 && !Session.get(SOURCE_FAV);\n});\nTemplate.registerHelper(\"isFavourite\", function (vocabularyId) {\n\tvar favEntry = Favourites.findOne({\n\t\tvocabularyId: vocabularyId\n\t});\n\tif (favEntry) {\n\t\treturn true;\n\t}\n});\nTemplate.registerHelper(\"favourites\", function () {\n\tvar favIds = R.pluck('vocabularyId')(Favourites.find({}).fetch());\n\tif (Favourites.find().count() !== 0) {\n\t\treturn Vocabulary.find({\n\t\t\t_id: {\n\t\t\t\t$in: favIds\n\t\t\t}\n\t\t}, {\n\t\t\tsort: {\n\t\t\t\tterm: 1\n\t\t\t}\n\t\t});\n\t} else {\n\t\treturn null;\n\t}\n});\nTemplate.registerHelper(\"entry\", function () {\n\tvar currentUserId = this.userId;\n\tvar favIds = R.pluck('vocabularyId')(Favourites.find().fetch());\n\tvar vocabulary = [];\n\n\tif (Session.get(SOURCE_FAV)) {\n\t\tvocabulary = Vocabulary.find({\n\t\t\t_id: {\n\t\t\t\t$in: favIds\n\t\t\t}\n\t\t}).fetch();\n\t} else {\n\t\tvocabulary = Vocabulary.find({\n\t\t\t_id: {\n\t\t\t\t$nin: favIds\n\t\t\t}\n\t\t}).fetch();\n\t}\n\treturn vocabulary[Session.get(COUNT_VIEWED)];\n});\n\nTemplate.layout.events({\n\t'click .btn-reveal': function () {\n\t\tfunction clickBtnReveal(event, template) {\n\t\t\tif (!Session.get(REVEALED)) {\n\t\t\t\tSession.set(REVEALED, true);\n\t\t\t}\n\t\t\tif (document.getElementById(\"term\")) {\n\t\t\t\tif (document.getElementById(\"term\").disabled === false) {\n\t\t\t\t\tdocument.getElementById(\"term\").disabled = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn clickBtnReveal;\n\t}(),\n\t'click .btn-forward, click .btn-backward': function () {\n\t\tfunction clickBtnForwardClickBtnBackward(event, template) {\n\t\t\tif (Session.get(REVEALED)) {\n\t\t\t\tSession.set(REVEALED, false);\n\t\t\t}\n\t\t\tif (Session.get(TERM_WRONG)) {\n\t\t\t\tSession.set(TERM_WRONG, false);\n\t\t\t}\n\t\t\tif (document.getElementById(\"term\")) {\n\t\t\t\tdocument.getElementById(\"term\").value = '';\n\t\t\t\tif (document.getElementById(\"term\").disabled === true) {\n\t\t\t\t\tdocument.getElementById(\"term\").disabled = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLocal.Viewed.upsert({\n\t\t\t\tvocabularyId: this._id,\n\t\t\t\tuserId: this.userId\n\t\t\t}, {\n\t\t\t\t$setOnInsert: {\n\t\t\t\t\tvocabularyId: this._id,\n\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\tvocabularyName: this.term\n\t\t\t\t},\n\t\t\t\t$inc: {\n\t\t\t\t\ttimesViewed: 1\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn clickBtnForwardClickBtnBackward;\n\t}(),\n\t'click .btn-backward': function () {\n\t\tfunction clickBtnBackward(event, template) {\n\t\t\tvar val = 0;\n\t\t\tif (Session.get(SOURCE_FAV)) {\n\t\t\t\t// reset to avoid going into negative numbers and be able to circle backwards\n\t\t\t\tif (Session.get(COUNT_VIEWED) === 0) {\n\t\t\t\t\tval = Session.get(LENGTH_FAV) - 1;\n\t\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t\t} else {\n\t\t\t\t\tval = (Session.get(COUNT_VIEWED) - 1) % Session.get(LENGTH_FAV);\n\t\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (Session.get(COUNT_VIEWED) === 0) {\n\t\t\t\t\tval = Session.get(LENGTH_NOT_FAV) - 1;\n\t\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t\t} else {\n\t\t\t\t\tval = (Session.get(COUNT_VIEWED) - 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn clickBtnBackward;\n\t}(),\n\t'click .btn-forward': function () {\n\t\tfunction clickBtnForward(event, template) {\n\t\t\tvar val = 0;\n\t\t\tif (Session.get(SOURCE_FAV)) {\n\t\t\t\tval = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t} else {\n\t\t\t\tval = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t}\n\t\t}\n\n\t\treturn clickBtnForward;\n\t}(),\n\t'click .btn-insert': function () {\n\t\tfunction clickBtnInsert(event, template) {\n\t\t\tMeteor.call('insertFavourite', this._id);\n\n\t\t\t// reset the COUNT VIEW when a list entry has been removed\n\t\t\tif (!Session.get(SOURCE_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_NOT_FAV) - 1) {\n\t\t\t\tvar val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t}\n\n\t\t\tif (Session.get(LENGTH_NOT_FAV) === 1) {\n\t\t\t\tSession.set(SOURCE_FAV, !Session.get(SOURCE_FAV));\n\t\t\t}\n\t\t}\n\n\t\treturn clickBtnInsert;\n\t}(),\n\t'click .btn-delete': function () {\n\t\tfunction clickBtnDelete(event, template) {\n\t\t\tMeteor.call('deleteFavourite', this._id);\n\t\t\tif (Session.get(SOURCE_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_FAV) - 1) {\n\t\t\t\tvar val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t}\n\n\t\t\tif (Session.get(LENGTH_FAV) === 1) {\n\t\t\t\tSession.set(SOURCE_FAV, !Session.get(SOURCE_FAV));\n\t\t\t}\n\t\t}\n\n\t\treturn clickBtnDelete;\n\t}()\n});","ast":null,"map":{"version":3,"sources":["/client/layout/layout.js"],"names":[],"mappings":"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","file":"/client/layout/layout.js.map","sourcesContent":["Template.layout.onCreated(function() {\n\tthis.autorun(() => {\n\n\t\tSession.set(LENGTH_FAV, Favourites.find().count());\n\t\tSession.set(LENGTH_NOT_FAV, Vocabulary.find().count() - Favourites.find().count());\n\t});\n});\n\n//  Session variables\n\nATTENTION_MODE = 'attentionMode';\nSession.setDefault(ATTENTION_MODE, false);\n\nLAST_PATH = 'lastPath';\nSession.setDefault(LAST_PATH, '/');\n\n// LAST_PATH_TRAINER = 'lastPathTrainer';\n// Session.setDefault(LAST_PATH_TRAINER, '/trainer/lesen');\n\nSOURCE_FAV = 'sourceFavourites';\nSession.setDefault(SOURCE_FAV, false);\n\nRANDOM_FAV = 'randomFavourites';\nSession.setDefault(RANDOM_FAV, false);\n\nRANDOM_NOT_FAV = 'randomNotFavourites';\nSession.setDefault(RANDOM_NOT_FAV, true);\n\nLENGTH_FAV = 'lengthFav';\nSession.setDefault(LENGTH_FAV, 0);\n\nLENGTH_NOT_FAV = 'lengthNotFav';\nSession.setDefault(LENGTH_NOT_FAV, 0);\n\nCOUNT_VIEWED = 'countViewed';\nSession.setDefault(COUNT_VIEWED, 0);\n\nREVEALED = 'revealed';\nSession.setDefault(REVEALED, false);\n\n// TERM_MODE = 'termMode';\n// Session.setDefault(TERM_MODE, true);\n\nTERM_WRONG = 'termWrong';\nSession.setDefault(TERM_WRONG, false);\n\nTERM_RIGHT = 'termRight';\nSession.setDefault(TERM_RIGHT, false);\n\nTERM_CACHE = 'termCache';\nSession.setDefault(TERM_CACHE, '');\n\nCOUNT_LETTERS_MATCH = 'countLettersMatch';\nSession.setDefault(COUNT_LETTERS_MATCH, 0);\n\nNAV_MODE_READ = 'lesen';\nSession.setDefault(NAV_MODE_READ, true);\n\nNAV_MODE_TERM = 'wort';\nSession.setDefault(NAV_MODE_TERM, false);\n\nNAV_MODE_DEF = 'definition';\nSession.setDefault(NAV_MODE_DEF, false);\n\nNAV_MODES = 'navModes';\nSession.setDefault(NAV_MODES, [NAV_MODE_READ, NAV_MODE_TERM, NAV_MODE_DEF]);\n\nNAV_MODE_COUNT = 'navModeCount';\nSession.setDefault(NAV_MODE_COUNT, 0);\n\n// Global helpers\n\n// e.g. {{getSession \"posX\"}} in Template\nTemplate.registerHelper('getSession', function(key) {\n\treturn Session.get(key);\n});\nTemplate.registerHelper('userMail', function() {\n\treturn Meteor.user().emails[0].address;\n});\nTemplate.registerHelper('isOwner', function() {\n\treturn this.userId == Meteor.userId();\n});\nTemplate.registerHelper(\"lengthIsOne\", function() {\n\treturn (Session.get(LENGTH_FAV) === 1) && Session.get(SOURCE_FAV) ||\n\t\t(Session.get(LENGTH_NOT_FAV) === 1) && !Session.get(SOURCE_FAV);\n});\nTemplate.registerHelper(\"isFavourite\", function(vocabularyId) {\n\tlet favEntry = Favourites.findOne({\n\t\tvocabularyId: vocabularyId\n\t});\n\tif (favEntry) {\n\t\treturn true;\n\t}\n});\nTemplate.registerHelper(\"favourites\", function() {\n\tlet favIds = R.pluck('vocabularyId')(Favourites.find({}).fetch());\n\tif (Favourites.find().count() !== 0) {\n\t\treturn Vocabulary.find({\n\t\t\t_id: {\n\t\t\t\t$in: favIds\n\t\t\t}\n\t\t}, {\n\t\t\tsort: {\n\t\t\t\tterm: 1\n\t\t\t}\n\t\t});\n\t} else {\n\t\treturn null;\n\t}\n});\nTemplate.registerHelper(\"entry\", function() {\n\tlet currentUserId = this.userId;\n\tlet favIds = R.pluck('vocabularyId')(Favourites.find().fetch());\n\tlet vocabulary = [];\n\n\tif (Session.get(SOURCE_FAV)) {\n\t\tvocabulary = Vocabulary.find({\n\t\t\t_id: {\n\t\t\t\t$in: favIds\n\t\t\t}\n\t\t}).fetch();\n\t} else {\n\t\tvocabulary = Vocabulary.find({\n\t\t\t_id: {\n\t\t\t\t$nin: favIds\n\t\t\t}\n\t\t}).fetch();\n\t}\n\treturn vocabulary[Session.get(COUNT_VIEWED)];\n})\n\nTemplate.layout.events({\n\t'click .btn-reveal' (event, template) {\n\t\tif (!Session.get(REVEALED)) {\n\t\t\tSession.set(REVEALED, true);\n\t\t}\n\t\tif (document.getElementById(\"term\")) {\n\t\t\tif (document.getElementById(\"term\").disabled === false) {\n\t\t\t\tdocument.getElementById(\"term\").disabled = true;\n\t\t\t}\n\t\t}\n\t},\n\n\t'click .btn-forward, click .btn-backward' (event, template) {\n\t\tif (Session.get(REVEALED)) {\n\t\t\tSession.set(REVEALED, false);\n\t\t}\n\t\tif (Session.get(TERM_WRONG)) {\n\t\t\tSession.set(TERM_WRONG, false);\n\t\t}\n\t\tif (document.getElementById(\"term\")) {\n\t\t\tdocument.getElementById(\"term\").value = '';\n\t\t\tif (document.getElementById(\"term\").disabled === true) {\n\t\t\t\tdocument.getElementById(\"term\").disabled = false;\n\t\t\t}\n\t\t}\n\n\t\tLocal.Viewed.upsert({\n\t\t\tvocabularyId: this._id,\n\t\t\tuserId: this.userId\n\t\t}, {\n\t\t\t$setOnInsert: {\n\t\t\t\tvocabularyId: this._id,\n\t\t\t\tuserId: this.userId,\n\t\t\t\tvocabularyName: this.term\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\ttimesViewed: 1\n\t\t\t}\n\t\t});\n\t},\n\n\t'click .btn-backward' (event, template) {\n\t\tlet val = 0;\n\t\tif (Session.get(SOURCE_FAV)) {\n\t\t\t// reset to avoid going into negative numbers and be able to circle backwards\n\t\t\tif (Session.get(COUNT_VIEWED) === 0) {\n\t\t\t\tval = Session.get(LENGTH_FAV) - 1;\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t} else {\n\t\t\t\tval = (Session.get(COUNT_VIEWED) - 1) % Session.get(LENGTH_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t}\n\t\t} else {\n\t\t\tif (Session.get(COUNT_VIEWED) === 0) {\n\t\t\t\tval = Session.get(LENGTH_NOT_FAV) - 1;\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t} else {\n\t\t\t\tval = (Session.get(COUNT_VIEWED) - 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t\t}\n\t\t}\n\n\t},\n\n\t'click .btn-forward' (event, template) {\n\t\tlet val = 0;\n\t\tif (Session.get(SOURCE_FAV)) {\n\t\t\tval = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_FAV);\n\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t} else {\n\t\t\tval = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t}\n\n\t},\n\n\t'click .btn-insert' (event, template) {\n\t\tMeteor.call('insertFavourite', this._id);\n\n\t\t// reset the COUNT VIEW when a list entry has been removed\n\t\tif (!Session.get(SOURCE_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_NOT_FAV) - 1) {\n\t\t\tlet val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_NOT_FAV);\n\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t}\n\n\t\tif (Session.get(LENGTH_NOT_FAV) === 1) {\n\t\t\tSession.set(SOURCE_FAV, !Session.get(SOURCE_FAV));\n\t\t}\n\n\t},\n\n\t'click .btn-delete' (event, template) {\n\t\tMeteor.call('deleteFavourite', this._id);\n\t\tif (Session.get(SOURCE_FAV) && Session.get(COUNT_VIEWED) >= Session.get(LENGTH_FAV) - 1) {\n\t\t\tlet val = (Session.get(COUNT_VIEWED) + 1) % Session.get(LENGTH_FAV);\n\t\t\tSession.set(COUNT_VIEWED, val);\n\t\t}\n\n\t\tif (Session.get(LENGTH_FAV) === 1) {\n\t\t\tSession.set(SOURCE_FAV, !Session.get(SOURCE_FAV));\n\t\t}\n\n\t}\n});\n"]},"hash":"1aa94286d5c1cd9775998c9610761aadd599173e"}
