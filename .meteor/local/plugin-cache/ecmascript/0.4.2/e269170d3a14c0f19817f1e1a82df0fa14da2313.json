{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/server/startup.js","filenameRelative":"/server/startup.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/server/startup.js.map","sourceFileName":"/server/startup.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"startup"},"ignored":false,"code":"Meteor.startup(function () {\n\tMeteor.users.find({\n\t\t\"status.online\": true\n\t}).observe({\n\t\tadded: function () {\n\t\t\tfunction added(obj) {\n\t\t\t\tvar latestEntry = Data.Status.findOne({ userId: obj._id }, { sort: { timestamp: -1, limit: 1 } });\n\t\t\t\t// console.log(obj._id + \" \" + latestEntry.status);\n\t\t\t\tif (latestEntry.status !== 'online') {\n\t\t\t\t\tData.Status.insert({\n\t\t\t\t\t\tuserId: obj._id,\n\t\t\t\t\t\tstatus: \"online\"\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log(obj._id + ' set online');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn added;\n\t\t}(),\n\t\tremoved: function () {\n\t\t\tfunction removed(obj) {\n\t\t\t\tvar latestEntry = Data.Status.findOne({ userId: obj._id }, { sort: { timestamp: -1, limit: 1 } });\n\t\t\t\t// console.log(obj._id + \" \" + latestEntry.status);\n\t\t\t\tif (latestEntry && latestEntry.status !== 'offline') {\n\t\t\t\t\tData.Status.insert({\n\t\t\t\t\t\tuserId: obj._id,\n\t\t\t\t\t\tstatus: \"offline\"\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log(obj._id + ' set offline');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn removed;\n\t\t}()\n\t});\n});","ast":null,"map":{"version":3,"sources":["/server/startup.js"],"names":[],"mappings":"AAAA,OAAO,OAAP,CAAe,YAAW;AACzB,QAAO,KAAP,CAAa,IAAb,CAAkB;AACjB,mBAAiB,IAAjB;EADD,EAEG,OAFH,CAEW;AACV;AAAO,kBAAS,GAAT,EAAc;AACpB,QAAI,cAAc,KAAK,MAAL,CAAY,OAAZ,CAAoB,EAAC,QAAQ,IAAI,GAAJ,EAA7B,EAAuC,EAAC,MAAM,EAAC,WAAW,CAAC,CAAD,EAAI,OAAO,CAAP,EAAtB,EAAxC,CAAd;;AADgB,QAGhB,YAAY,MAAZ,KAAuB,QAAvB,EAAiC;AACpC,UAAK,MAAL,CAAY,MAAZ,CAAmB;AAClB,cAAQ,IAAI,GAAJ;AACR,cAAQ,QAAR;MAFD,EADoC;AAKnC,aAAQ,GAAR,CAAY,IAAI,GAAJ,GAAU,aAAV,CAAZ,CALmC;KAArC;IAHM;;;KAAP;AAWA;AAAS,oBAAS,GAAT,EAAc;AACtB,QAAI,cAAc,KAAK,MAAL,CAAY,OAAZ,CAAoB,EAAC,QAAQ,IAAI,GAAJ,EAA7B,EAAuC,EAAC,MAAM,EAAC,WAAW,CAAC,CAAD,EAAI,OAAO,CAAP,EAAtB,EAAxC,CAAd;;AADkB,QAGlB,eAAe,YAAY,MAAZ,KAAuB,SAAvB,EAAkC;AACpD,UAAK,MAAL,CAAY,MAAZ,CAAmB;AAClB,cAAQ,IAAI,GAAJ;AACR,cAAQ,SAAR;MAFD,EADoD;AAKnD,aAAQ,GAAR,CAAY,IAAI,GAAJ,GAAU,cAAV,CAAZ,CALmD;KAArD;IAHQ;;;KAAT;EAdD,EADyB;CAAX,CAAf","file":"/server/startup.js.map","sourcesContent":["Meteor.startup(function() {\n\tMeteor.users.find({\n\t\t\"status.online\": true\n\t}).observe({\n\t\tadded: function(obj) {\n\t\t\tlet latestEntry = Data.Status.findOne({userId: obj._id}, {sort: {timestamp: -1, limit: 1}});\n\t\t\t// console.log(obj._id + \" \" + latestEntry.status);\n\t\t\tif (latestEntry.status !== 'online') {\n\t\t\t\tData.Status.insert({\n\t\t\t\t\tuserId: obj._id,\n\t\t\t\t\tstatus: \"online\"\n\t\t\t\t});\n\t\t\t\t\tconsole.log(obj._id + ' set online');\n\t\t\t}\n\t\t},\n\t\tremoved: function(obj) {\n\t\t\tlet latestEntry = Data.Status.findOne({userId: obj._id}, {sort: {timestamp: -1, limit: 1}});\n\t\t\t// console.log(obj._id + \" \" + latestEntry.status);\n\t\t\tif (latestEntry && latestEntry.status !== 'offline') {\n\t\t\t\tData.Status.insert({\n\t\t\t\t\tuserId: obj._id,\n\t\t\t\t\tstatus: \"offline\"\n\t\t\t\t});\n\t\t\t\t\tconsole.log(obj._id + ' set offline');\n\t\t\t}\n\t\t}\n\t});\n});\n"]},"hash":"e269170d3a14c0f19817f1e1a82df0fa14da2313"}
