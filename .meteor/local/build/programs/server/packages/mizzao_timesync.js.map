{"version":3,"sources":["meteor://ðŸ’»app/packages/mizzao:timesync/timesync-server.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,OAAO,kBAAP,CAA0B,GAA1B,CAA8B,YAA9B,EACE,UAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB,EAAyB;;;AAGvB,MAAI,SAAJ,CAAc,eAAd,EAA+B,qCAA/B,EAHuB;AAIvB,MAAI,SAAJ,CAAc,QAAd,EAAwB,UAAxB,EAJuB;AAKvB,MAAI,SAAJ,CAAc,SAAd,EAAyB,CAAzB;;;AALuB,KAQvB,CAAI,SAAJ,CAAc,cAAd,EAA8B,YAA9B;;;;;;AARuB,MAcjB,SAAS,IAAI,OAAJ,CAAY,MAAZ,CAdQ;;AAgBvB,MAAI,WAAY,WAAW,qBAAX,IACZ,mCAAmC,IAAnC,CAAwC,MAAxC,CADY,CAAZ,EACoD;AACtD,QAAI,SAAJ,CAAc,6BAAd,EAA6C,MAA7C,EADsD;GADxD;;AAKA,MAAI,GAAJ,CAAQ,KAAK,GAAL,GAAW,QAAX,EAAR,EArBuB;CAAzB,CADF,yG","file":"/packages/mizzao_timesync.js","sourcesContent":["// Use rawConnectHandlers so we get a response as quickly as possible\n// https://github.com/meteor/meteor/blob/devel/packages/webapp/webapp_server.js\n\nWebApp.rawConnectHandlers.use(\"/_timesync\",\n  function(req, res, next) {\n    // Never ever cache this, otherwise weird times are shown on reload\n    // http://stackoverflow.com/q/18811286/586086\n    res.setHeader(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n    res.setHeader(\"Pragma\", \"no-cache\");\n    res.setHeader(\"Expires\", 0);\n\n    // Avoid MIME type warnings in browsers\n    res.setHeader(\"Content-Type\", \"text/plain\");\n\n    // Cordova lives in a local webserver, so it does CORS\n    // we need to bless it's requests in order for it to accept our results\n    // Match http://localhost:<port> for Cordova clients in Meteor 1.3\n    // and http://meteor.local for earlier versions\n    const origin = req.headers.origin;\n\n    if (origin && ( origin === 'http://meteor.local' ||\n        /^http:\\/\\/localhost:1[23]\\d\\d\\d$/.test(origin) ) ) {\n      res.setHeader('Access-Control-Allow-Origin', origin);\n    }\n\n    res.end(Date.now().toString());\n  }\n);\n"]}